import java
import semmle.code.java.dataflow.DataFlow
private import semmle.code.java.dataflow.ExternalFlow

predicate isGPTDetectedStep(DataFlow::Node prev, DataFlow::Node next) {
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "String")
        and c.getCallee().getName() = "substring"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "String")
        and c.getCallee().getName() = "substring"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "Boolean")
        and c.getCallee().getName() = "valueOf"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuffer")
        and c.getCallee().getName() = "toString"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuilder")
        and c.getCallee().getName() = "append"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.net", "URLDecoder")
        and c.getCallee().getName() = "decode"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("org.eclipse.jetty.http.pathmap", "ServletPathSpec")
        and c.getCallee().getName() = "ServletPathSpec"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuilder")
        and c.getCallee().getName() = "insert"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuilder")
        and c.getCallee().getName() = "append"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.io", "File")
        and c.getCallee().getName() = "File"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.net", "URI")
        and c.getCallee().getName() = "toURL"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "String")
        and c.getCallee().getName() = "split"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "String")
        and c.getCallee().getName() = "replace"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "String")
        and c.getCallee().getName() = "replaceAll"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "String")
        and c.getCallee().getName() = "replace"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuffer")
        and c.getCallee().getName() = "append"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.net", "URI")
        and c.getCallee().getName() = "URI"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuilder")
        and c.getCallee().getName() = "append"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuilder")
        and c.getCallee().getName() = "append"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.lang", "StringBuilder")
        and c.getCallee().getName() = "append"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.io", "File")
        and c.getCallee().getName() = "File"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("org.eclipse.jetty.util", "URIUtil")
        and c.getCallee().getName() = "encodePath"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.net", "URLEncoder")
        and c.getCallee().getName() = "encode"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.net", "URI")
        and c.getCallee().getName() = "create"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("java.io", "File")
        and c.getCallee().getName() = "File"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("org.apache.http.util", "EntityUtils")
        and c.getCallee().getName() = "toString"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("org.apache.http.entity", "StringEntity")
        and c.getCallee().getName() = "StringEntity"
        and c = next.asExpr()
    )
    or
    exists(Call c |
        (c.getArgument(_) = prev.asExpr() or c.getQualifier() = prev.asExpr())
        and c.getCallee().getDeclaringType().hasQualifiedName("org.apache.http.client.methods", "HttpRequestBase")
        and c.getCallee().getName() = "setURI"
        and c = next.asExpr()
    )
}
